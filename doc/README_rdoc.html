<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=CP850" http-equiv="Content-Type">

<title>Gemfile</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body class="file">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./Gemfile.html">Gemfile</a>
  
    <li class="file"><a href="./LICENCE.html">LICENCE</a>
  
    <li class="file"><a href="./README_rdoc.html">README</a>
  
    <li class="file"><a href="./Rakefile.html">Rakefile</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Positionable.html">Positionable</a>
  
    <li><a href="./Positionable/PositionableMethods.html">Positionable::PositionableMethods</a>
  
    <li><a href="./Positionable/PositionableMethods/InstanceMethods.html">Positionable::PositionableMethods::InstanceMethods</a>
  
    <li><a href="./Array.html">Array</a>
  
    <li><a href="./Document.html">Document</a>
  
    <li><a href="./Dummy.html">Dummy</a>
  
    <li><a href="./Folder.html">Folder</a>
  
    <li><a href="./Item.html">Item</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation" class="description">
  
<h1 id="label-Positionable"><a href="Positionable.html">Positionable</a></h1>

<p><strong><a href="Positionable.html">Positionable</a></strong> is a library
which provides contiguous positionning capabilities to your ActiveRecord
models.</p>

<p>For more functionalities, you could also have a look at <a
href="https://github.com/swanandp/acts_as_list">acts_as_list</a>.</p>

<h2 id="label-Installation">Installation</h2>

<p>Edit your <a href="Gemfile.html">Gemfile</a>, and simply add the following
line:</p>

<pre class="ruby"><span class="ruby-identifier">gem</span> <span class="ruby-string">'positionable'</span>, :<span class="ruby-identifier">git</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;git://github.com/pguegan/positionable.git&quot;</span>
</pre>

<h2 id="label-Getting+Started">Getting Started</h2>

<p>Let's say you want to make the model <code>Item</code> positionable.</p>

<h3 id="label-Create+a+migration">Create a migration</h3>

<p>First, create a migration to add the column <code>position</code> to the
table <code>items</code>:</p>

<pre>rails generate migration add_position_to_items position:integer</pre>

<p>Then, run the migration:</p>

<pre>rake db:migrate</pre>

<h3 id="label-Setup+your+model">Setup your model</h3>

<p>Simply add the <code>is_positionable</code> method in your ActiveRecord
model:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Item</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">is_positionable</span>
<span class="ruby-keyword">end</span>
</pre>

<h4 id="label-Grouping+records">Grouping records</h4>

<p>Maybe your items are grouped (typically with a <code>belongs_to</code>
association). In this case, you'll want to restrict the position in each
group by declaring the <code>:parent</code> option:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Item</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">folder</span>
  <span class="ruby-identifier">is_positionable</span> :<span class="ruby-identifier">parent</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">folder</span>
<span class="ruby-keyword">end</span>
</pre>

<h4 id="label-Start+position">Start position</h4>

<p>By default, position starts by zero. But you may want to change this at the
model level, for instance by starting at one (which seems more natural for
some people):</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Item</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">is_positionable</span> :<span class="ruby-identifier">start</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span>
</pre>

<h4 id="label-Ordering">Ordering</h4>

<p>When a new record is created, it is inserted by default at the last
(highest) position of its group. Thus, when record are listed, the newly
created record will appear at the bottom.</p>

<p>It is possible to change this behaviour by setting the <code>order</code>
option as follows:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Item</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">is_positionable</span> :<span class="ruby-identifier">order</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">desc</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This way, records are always listed by descending positions order. Record
that have the highest position will appears at the top.</p>

<p>&lt;strong&gt;Caution!&lt;/strong&gt; The semantic of <code>next</code> or
<code>previous</code> methods remain unchanged. More precisely, even if the
highest position matches with the <em>first</em> returned record, it is
still considered as the <em>last</em> one. This is odd, so the semantic of
some methods will certainly be modified in a further version.</p>

<h2 id="label-Usage">Usage</h2>

<p>You can change the position of your items:</p>

<pre>item = Item.create(...) # The newly created item is set at the last position
item.up! # Item's position is decremented by one
item.down! # Item's position is incremented by one</pre>

<p>You can also get the previous or next sibbling items:</p>

<pre>previous = item.previous
all_previous = item.all_previous
next = item.next
all_next = item.all_next</pre>

<p>Both first and last items can be caracterized like this:</p>

<pre>item.first? # True if item.previous is nil
item.last? # True if item.next is nil</pre>

</div>



<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.11.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

